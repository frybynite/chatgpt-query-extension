<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>ChatGPT Custom Prompts - Configuration</title>
  <link rel="stylesheet" href="options.css">
</head>
<body>
  <div class="container">
    <header>
      <div class="header-left">
        <button id="hamburger-menu" class="hamburger-btn" aria-label="Menu" aria-expanded="false">
          <span class="hamburger-icon">☰</span>
        </button>
        <div id="dropdown-menu" class="dropdown-menu hidden">
          <button id="export-config" class="dropdown-item">Export Menus...</button>
          <button id="import-config" class="dropdown-item">Import Menus...</button>
          <div class="dropdown-separator"></div>
          <label class="dropdown-item dropdown-checkbox">
            <input type="checkbox" id="debug-logging-toggle">
            <span>Debug Logging</span>
          </label>
        </div>
        <h1>ChatGPT Custom Prompts</h1>
      </div>
      <img src="icons/icon-48.png" alt="ChatGPT Custom Prompts Icon" class="header-icon">
      <input type="file" id="import-file-input" accept=".json" style="display: none;" />
    </header>

    <!-- Error banner (hidden by default) -->
    <div id="error-banner" class="error-banner hidden"></div>

    <!-- Warning banner (hidden by default) -->
    <div id="warning-banner" class="warning-banner hidden"></div>

    <!-- Success banner (hidden by default) -->
    <div id="success-banner" class="success-banner hidden"></div>

    <!-- Modal Overlay -->
    <div id="modal-overlay" class="modal-overlay hidden">
      <div class="modal-dialog">
        <div class="modal-header">
          <div class="modal-header-content">
            <span class="modal-icon" id="modal-icon"></span>
            <h3 class="modal-title" id="modal-title"></h3>
          </div>
          <button type="button" class="modal-close" id="modal-close" aria-label="Close">×</button>
        </div>
        <div class="modal-body">
          <p id="modal-message"></p>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn-secondary" id="modal-cancel" style="display: none;">Cancel</button>
          <button type="button" class="btn-primary" id="modal-ok">OK</button>
        </div>
      </div>
    </div>

    <!-- Main Content: Sidebar + Detail Panel -->
    <div class="main-content">
      <!-- Left Sidebar: Menu List -->
      <aside class="menu-sidebar">
        <div class="menu-sidebar-header">
          <h2>Menus</h2>
          <button id="add-menu" class="btn-add-menu" title="Add Menu">+</button>
        </div>

        <div id="menu-list" class="menu-list">
          <!-- Menu items will be dynamically inserted here -->
        </div>

        <div class="menu-sidebar-footer">
          <div id="menu-count" class="menu-count">0/10 menus</div>
        </div>
      </aside>

      <!-- Right Panel: Selected Menu Details -->
      <main class="menu-detail-panel">
        <div id="no-menu-selected" class="no-menu-selected">
          <p>Select a menu from the sidebar or create a new one</p>
        </div>

        <div id="menu-detail-content" class="menu-detail-content hidden">
          <!-- Menu Configuration Section -->
          <section class="menu-config-section">
            <h2>Menu Configuration</h2>

            <div class="form-group">
              <label for="menuName">
                Menu Name <span class="required">*</span>
                <button type="button" class="info-icon" data-info="menuNameInfo" aria-label="Show information">ⓘ</button>
              </label>
              <div class="input-with-hint">
                <input
                  type="text"
                  id="menuName"
                  placeholder="Send to ChatGPT"
                  maxlength="50"
                  required
                />
                <span class="inline-hint">(max 50)</span>
              </div>
              <!-- Info popup -->
              <div id="menuNameInfo" class="info-popup">
                <div class="info-popup-content">
                  <p>This name appears in the right-click context menu.</p>
                  <button type="button" class="info-popup-close" aria-label="Close">×</button>
                </div>
              </div>
            </div>

            <div class="form-group">
              <label for="customGptUrl">
                ChatGPT URL <span class="required">*</span>
                <button type="button" class="info-icon" data-info="customGptUrlInfo" aria-label="Show information">ⓘ</button>
                <span class="inline-hint">(Use chatgpt.com or create a custom GPT at <a href="https://chatgpt.com/gpts/mine" target="_blank" rel="noopener noreferrer">chatgpt.com/gpts/mine</a>)</span>
              </label>
              <input
                type="url"
                id="customGptUrl"
                placeholder="https://chatgpt.com/ or https://chatgpt.com/g/g-..."
                required
              />
              <!-- Info popup -->
              <div id="customGptUrlInfo" class="info-popup">
                <div class="info-popup-content">
                  <p>The URL of your custom ChatGPT assistant.</p>
                  <button type="button" class="info-popup-close" aria-label="Close">×</button>
                </div>
              </div>
            </div>

            <div class="form-group">
              <label>
                <input type="checkbox" id="autoSubmit" />
                <span>Auto Submit</span>
                <button type="button" class="info-icon" data-info="autoSubmitInfo" aria-label="Show information">ⓘ</button>
              </label>
              <!-- Info popup -->
              <div id="autoSubmitInfo" class="info-popup">
                <div class="info-popup-content">
                  <p>Automatically submit prompts without manual send.</p>
                  <button type="button" class="info-popup-close" aria-label="Close">×</button>
                </div>
              </div>
            </div>

            <div class="form-group">
              <label>
                <input type="checkbox" id="runAllEnabled" />
                <span>Enable "Run All Actions"</span>
                <button type="button" class="info-icon" data-info="runAllEnabledInfo" aria-label="Show information">ⓘ</button>
              </label>
              <!-- Info popup -->
              <div id="runAllEnabledInfo" class="info-popup">
                <div class="info-popup-content">
                  <p>Show "Run All" in this menu's context menu and enable keyboard shortcut.</p>
                  <button type="button" class="info-popup-close" aria-label="Close">×</button>
                </div>
              </div>
            </div>

            <div class="form-group shortcut-group" id="runAllShortcutGroup">
              <label for="runAllShortcut">
                Run All Actions Shortcut
                <button type="button" class="info-icon" data-info="runAllShortcutInfo" aria-label="Show information">ⓘ</button>
              </label>
              <div class="shortcut-capture">
                <input type="text" id="runAllShortcut" placeholder="None" readonly />
                <button type="button" class="btn-icon btn-capture" id="runAllShortcutBtn" title="Record shortcut">⌨️</button>
              </div>
              <!-- Info popup -->
              <div id="runAllShortcutInfo" class="info-popup">
                <div class="info-popup-content">
                  <p>Keyboard shortcut to run all enabled actions in this menu.</p>
                  <button type="button" class="info-popup-close" aria-label="Close">×</button>
                </div>
              </div>
            </div>
          </section>

          <!-- Actions Section -->
          <section class="actions-section">
            <div class="section-header">
              <h2>Actions</h2>
              <button id="add-action" class="btn-secondary">+ Add Action</button>
            </div>

            <div id="actions-list">
              <!-- Actions will be dynamically inserted here -->
            </div>
          </section>

          <!-- Reload Reminder Note -->
          <div id="reload-reminder" class="reload-reminder hidden">
            <strong>NOTE:</strong> You will need to reload any open window/tab for keyboard shortcut changes to take effect
          </div>

          <!-- Save/Delete Buttons -->
          <footer class="menu-detail-footer">
            <button id="save" class="btn-primary">Save Changes</button>
            <button id="delete-menu" class="btn-danger">Delete Menu</button>
          </footer>
        </div>
      </main>
    </div>
  </div>

  <!-- Menu Item Template (hidden) -->
  <template id="menu-template">
    <div class="menu-item" data-menu-id="">
      <span class="menu-drag-handle" title="Drag to reorder">≡</span>
      <span class="menu-name">Menu Name</span>
    </div>
  </template>

  <!-- Action Item Template (hidden) -->
  <template id="action-template">
    <div class="action-item" data-action-id="">
      <div class="action-header">
        <span class="drag-handle" title="Drag to reorder">≡</span>
        <input type="text" class="action-title" placeholder="Action Title *" />
        <div class="action-controls">
          <button class="btn-icon" data-action="move-up" title="Move up">↑</button>
          <button class="btn-icon" data-action="move-down" title="Move down">↓</button>
          <button class="btn-icon btn-delete" data-action="delete" title="Delete">×</button>
        </div>
      </div>
      <div class="action-body">
        <div class="form-group">
          <label>Prompt <span class="required">*</span></label>
          <textarea class="action-prompt" placeholder="Prompt to send to GPT..." rows="2"></textarea>
        </div>
        <div class="form-group shortcut-group">
          <label>Keyboard Shortcut</label>
          <div class="shortcut-capture">
            <input type="text" class="action-shortcut" placeholder="None" readonly />
            <button class="btn-icon btn-capture" title="Record shortcut">⌨️</button>
          </div>
        </div>
        <div class="form-group">
          <label>
            <input type="checkbox" class="action-enabled" />
            <span>Enabled</span>
          </label>
        </div>
      </div>
    </div>
  </template>

  <script type="module" src="options.js"></script>
</body>
</html>
